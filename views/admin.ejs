<% layout('layouts/boilerplate') %>
<link rel="stylesheet" href="/css/admin.css" />
<h1>Admin</h1>
<h2>Class Code: <%= classroom.classCode %></h2>
<h2>Leaders:</h2>
<ul class="leaderList">
	<% for (i=0;i < leaders.length; i++) {%>
	<li>
		<%= leaders[i].username %> <%= leaders[i].cpClass?leaders[i].cpClass:'' %>
		<form
			class="delete confirm-remove-user"
			action="/class/<%= id %>/admin/leader/<%= leaders[i].id %>?_method=delete"
			method="post"
		>
			<button type="submit">Remove From Class</button>
		</form>
		<ul>
			<% for (job in interested[leaders[i].id]) { let inter =
			interested[leaders[i].id][job];%>
			<li>
				<%= inter.title %>
				<select class="interested-status" id="<%= inter.interestedId %>">
					<option value="new" <%=inter.status==='new'?'selected':''%>>New</option>
					<option value="followUp"<%=inter.status==='followUp'?'selected':''%>>Followed Up</option>
					<option value="nextSteps"<%=inter.status==='nextSteps'?'selected':''%>>Next Steps</option>
					<option value="badFit"<%=inter.status==='badFit'?'selected':''%>>Bad Fit</option>
				</select>
				<%if(inter.date <= 3){ %>
				<span class="pill">New</span>
				<% } %>
			</li>
			<% } %>
		</ul>
	</li>
	<% } %>
</ul>
<form action="/class/<%= id %>/admin/add-leader" method="post" class="add">
	<h3>Add Leader</h3>
	<div>
		<span
			><label for="password">Password</label
			><input type="text" id="password" name="password" minlength="8" required
		/></span>
		<span
			><label for="class">Class</label>
			<input type="text" id="class" name="cpClass" required
		/></span>
	</div>
	<div id="leaders"></div>
	<div>
		<button id="leader-btn-add" name="Leader">Add</button>
		<button id="leader-btn-remove">Remove</button>
	</div>
	<button type="submit">Submit</button>
</form>
<h2>Admin:</h2>
<ul class="adminList">
	<% for (i=0;i < admin.length; i++) {%>
	<li>
		<%= admin[i].username %> <% if (user.permissions === 'owner') {%>
		<form
			class="delete confirm-remove-user"
			action="/class/<%= id %>/admin/admin/<%= admin[i].id %>?_method=delete"
			method="post"
		>
			<button type="submit">Remove From Class</button>
		</form>
		<% } %>
	</li>
	<% } %>
</ul>
<% if (user.permissions === 'owner') {%>
<form action="/class/<%= id %>/admin/add-admin" method="post" class="add">
	<h3>Add Admin</h3>
	<label for="username">Username</label>
	<input type="text" id="username" name="username" minlength="2" required />
	<button type="submit">Submit</button>
</form>
<% } %>
<h2>Tags:</h2>
<ul>
	<% for (let tag of classroom.validTags){%>
		<li><%= tag %>
		<form
			class="delete confirm-remove-tag"
			action="/class/<%= id %>/admin/tag/<%= tag %>?_method=delete"
			method="post"
		>
			<button type="submit">Remove Tag</button>
		</form></li>
	<% } %>
</ul>
<form action="/class/<%= id %>/admin/tag" method="post" class="add">
	<h3>Add Tag</h3>
	<label for="tag">Tag</label>
	<input type="text" id="tag" name="tag" required>
	<button type="submit">Add Tag</button>
</form>

<h2>Career Tracks:</h2>
<ul>
	<% for (let ct of classroom.validCareerTracks){%>
		<li><%= ct %>
		<form
			class="delete confirm-remove-tag"
			action="/class/<%= id %>/admin/career-track/<%= ct %>?_method=delete"
			method="post"
		>
			<button type="submit">Remove Career</button>
		</form></li>
	<% } %>
</ul>
<form action="/class/<%= id %>/admin/career-track" method="post" class="add">
	<h3>Add Career</h3>
	<label for="career">Career Track</label>
	<input type="text" id="career" name="career" required>
	<button type="submit">Add Career Track</button>
</form>

<script>
	const classId = '<%=classroom.id%>';
</script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="/javascript/adminPanel.js"></script>
